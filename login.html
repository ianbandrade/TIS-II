<!DOCTYPE html>
<html lang="pt-br">

<head>
  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
  <title>Login</title>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8=" crossorigin="anonymous"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery.mask/1.14.16/jquery.mask.min.js"></script>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.css">
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/semantic.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/components/visibility.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/components/sidebar.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.4.2/dist/components/transition.js"></script>
  <script src="js/login.js"></script>

  <link rel="stylesheet" href="css/index.css">
  <link rel="stylesheet" href="css/forms.css">
</head>

<body>

  <header>
    <div class="ui large top  menu">
      <div class="ui container">
        <a href="index.html" class="item">Início</a>
        <a href="lista_vagas.html" class="item">Vagas</a>
        <a href="cadastro_vaga.html" class="item">Cadastro de Vagas</a>
        <a href="mapa_vagas.html" class="item">Mapa de Vagas</a>
        <a href="desempenho.html" class="item">Desempenho</a>
        <div class="right menu">
          <div class="item">
            <a href="login.html" class="ui button">Login</a>
          </div>
          <div class="item">
            <a href="cadastro_usuario.html" class="ui primary button">Cadastre-se</a>
          </div>
        </div>
      </div>
    </div>
  </header>

  <div class="ui middle aligned center aligned grid">
    <div class="column">
      <h1 class="ui image header">
        <img src="img/vagalugueLaranja.png" class="image">
        <div class="content parag">
          Entre com sua conta
        </div>
      </h1>
      <form class="ui large form">
        <div class="ui stacked segment">
          <div class="field">
            <div class="ui left icon input">
              <i class="user icon"></i>
              <input id="email" type="text" name="email" value="" placeholder="E-mail">
            </div>
          </div>
          <div class="field">
            <div class="ui left icon input">
              <i class="lock icon"></i>
              <input id="senha" type="password" name="senha" value="" placeholder="Senha">
            </div>
          </div>
          <input id="submit-btn" value="Entrar" class="ui form fluid large submit button">
        </div>
        <div class="ui error message"></div>
      </form>

      <div class="ui message">
        Novo por aqui? <a href="cadastro_usuario.html">Cadastre-se</a>
      </div>
    </div>
  </div>

  <footer class="ui landing-image-footer inverted vertical footer segment">
    <div class="ui container">
      <div class="ui stackable inverted divided equal height stackable grid">
        <div class="four wide column">
          <div class="ui inverted list">
            <p class="item">Beatriz Melo</p>
            <p class="item">Belle Nerissa </p>
            <p class="item">Camila Campos</p>
          </div>
        </div>
        <div class="four wide column">
          <div class="ui inverted list">
            <p class="item">Ian Bittencourt</p>
            <p class="item">Ian Guelman</p>
          </div>
        </div>
        <div class="four wide column">
          <h3 class="ui inverted header">Páginas</h3>
          <div class="ui inverted link list">
            <a href="index.html" class="item">Home</a>
            <a href="#" class="item">Locatário</a>
            <a href="#" class="item">Locador</a>
          </div>
        </div>
        <div class="three wide column">
          <h3 class="ui inverted header">Codigo</h3>
          <a href="">
            <i class="github icon" id="github_icon"></i>
          </a>
        </div>
      </div>
    </div>
  </footer>

  <script>
    function limpa_form() {
      $('#email').val("")
      $('#senha').val("")
    }

    $('#submit-btn').click(async function (event) {
      event.preventDefault();
      let email = $('#email').val()
      let senha = $('#senha').val()

      try {
        let response = await $.getJSON("http://localhost:880/login?email=" + email + "&senha=" + senha);
        console.log(response)
        limpa_form();
        if (response.Login == true) {
          localStorage.setItem("email", response.Email)
          localStorage.setItem("nome", response.Nome)
          localStorage.setItem("sobrenome", response.Sobrenome)
          alert("logado")
          window.location.href = "index.html";
        } else
          alert("nao logado")
      } catch (error) {
        console.log(error);
      }
    });

    $('#senha').on('keypress', async function (e) {
      if (e.which == 13) {
        event.preventDefault();
        let email = $('#email').val()
        let senha = $('#senha').val()

        try {
          let response = await $.getJSON("http://localhost:880/login?email=" + email + "&senha=" + senha);
          console.log(response)
          limpa_form();
          if (response.Login == true) {
            localStorage.setItem("email", response.Email)
            localStorage.setItem("nome", response.Nome)
            localStorage.setItem("sobrenome", response.Sobrenome)
            alert("logado")
            window.location.href = "index.html";
          } else
            alert("nao logado")
        } catch (error) {
          console.log(error);
        }
      }
    });
  </script>

</body>

</html>